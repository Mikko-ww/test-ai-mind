# 需求文档

> **Issue**: #11
> **创建时间**: 2026-02-06
> **状态**: 待审批

## 需求概述

### 需求描述

在项目根目录创建一个 `game` 目录，用于存放Python小游戏项目。在 `game` 目录下实现一个简单的贪吃蛇（Snake）游戏，使用Python开发，并通过uv工具进行Python环境和依赖管理。游戏应该保持简单易懂，适合作为Python游戏开发的入门示例。

### 用意与目标

**主要目标：**
- 熟悉Python游戏开发的基本流程和技术
- 学习使用uv工具管理Python项目和依赖
- 创建可复用的游戏项目结构，为后续添加更多小游戏做准备
- 简化任务规划，将整个需求作为单个可执行任务完成

**预期收益：**
- 掌握Python游戏开发的基础知识
- 建立标准化的Python项目管理流程
- 为团队提供Python小游戏的参考实现
- 提升Python编程技能和项目组织能力

## 背景分析

### 当前问题

项目当前缺少Python游戏开发的实践案例和参考代码，团队成员需要通过实际项目来学习和掌握Python游戏开发技术。同时，需要建立一个统一的Python项目管理规范，使用现代化的工具（如uv）来管理依赖和环境。

### 业务价值

- **技能提升**：通过实践项目提升团队的Python开发能力
- **知识积累**：为项目积累Python游戏开发的经验和代码资产
- **标准化**：建立Python项目的标准化管理流程
- **可扩展性**：为后续添加更多小游戏项目提供基础架构

### 用户场景

开发者可以通过以下场景使用本项目：
1. 学习Python游戏开发的基础知识
2. 了解如何使用uv管理Python项目
3. 参考贪吃蛇游戏的实现代码，学习游戏逻辑设计
4. 在本地运行游戏，体验Python游戏开发成果
5. 基于现有代码进行扩展和改进

## 功能范围

### 包含功能

- ✅ 创建 `game` 目录结构
- ✅ 使用uv初始化Python项目
- ✅ 实现贪吃蛇游戏核心功能：
  - 蛇的移动控制（上下左右）
  - 食物的随机生成
  - 蛇吃到食物后身体增长
  - 碰撞检测（撞墙或撞到自己则游戏结束）
  - 得分统计
- ✅ 简单的图形界面显示
- ✅ 游戏暂停/重新开始功能
- ✅ 提供README文档说明如何运行游戏

### 不包含功能

- ❌ 复杂的游戏音效和背景音乐
- ❌ 多人游戏或网络对战功能
- ❌ 高级图形特效和动画
- ❌ 游戏难度等级设置
- ❌ 排行榜和成绩保存功能
- ❌ 移动端适配
- ❌ 复杂的游戏菜单系统

## 用户故事

### 用户故事1：项目初始化

**作为** 开发者  
**我想要** 使用uv工具初始化Python项目  
**以便** 能够方便地管理项目依赖和Python环境

**验收标准：**
- [ ] game目录包含uv项目配置文件（pyproject.toml）
- [ ] 可以通过uv命令安装和管理依赖
- [ ] 项目结构清晰，符合Python项目规范

### 用户故事2：游戏基本玩法

**作为** 玩家  
**我想要** 使用方向键控制贪吃蛇移动  
**以便** 能够引导蛇吃到食物并避免碰撞

**验收标准：**
- [ ] 按方向键可以控制蛇的移动方向
- [ ] 蛇会自动持续移动
- [ ] 蛇吃到食物后身体变长
- [ ] 碰到墙壁或自己身体时游戏结束

### 用户故事3：游戏界面显示

**作为** 玩家  
**我想要** 看到清晰的游戏界面  
**以便** 能够了解游戏状态和当前得分

**验收标准：**
- [ ] 游戏窗口显示游戏区域、蛇和食物
- [ ] 界面显示当前得分
- [ ] 游戏结束时显示最终得分
- [ ] 界面简洁清晰，易于理解

### 用户故事4：游戏运行

**作为** 开发者  
**我想要** 简单地启动和运行游戏  
**以便** 快速测试和体验游戏

**验收标准：**
- [ ] README文档包含详细的运行说明
- [ ] 可以通过简单的命令启动游戏
- [ ] 游戏运行稳定，无崩溃问题

## 功能需求

### 功能1：项目结构初始化

**描述：** 创建game目录，并使用uv初始化Python项目，配置基本的项目结构和依赖管理。

**输入：** 无（手动执行初始化命令）

**处理：** 
- 创建game目录
- 运行uv init初始化项目
- 配置pyproject.toml文件
- 添加pygame依赖

**输出：** 完整的Python项目结构，包含配置文件和依赖定义

**边界条件：**
- 确保uv工具已安装
- 避免覆盖已存在的game目录

### 功能2：游戏主循环

**描述：** 实现游戏的主循环逻辑，包括事件处理、游戏状态更新和画面渲染。

**输入：** 玩家的键盘输入（方向键）

**处理：** 
- 初始化pygame和游戏窗口
- 在游戏循环中处理键盘事件
- 更新游戏状态（蛇的位置、食物状态等）
- 渲染游戏画面

**输出：** 持续运行的游戏窗口，响应玩家输入

**边界条件：**
- 控制游戏帧率（如30-60 FPS）
- 正确处理窗口关闭事件

### 功能3：蛇的移动和控制

**描述：** 实现蛇的移动逻辑和方向控制。

**输入：** 方向键输入（上、下、左、右）

**处理：** 
- 维护蛇的身体坐标列表
- 根据当前方向更新蛇头位置
- 移动蛇身（身体跟随蛇头）
- 防止蛇180度转向（如向左移动时不能直接向右）

**输出：** 蛇在游戏区域内的移动

**边界条件：**
- 蛇不能反向移动（如从右直接转到左）
- 蛇的移动速度应该适中且一致

### 功能4：食物生成和碰撞检测

**描述：** 在游戏区域内随机生成食物，检测蛇是否吃到食物。

**输入：** 蛇头的当前位置

**处理：** 
- 在游戏区域内随机生成食物坐标
- 检测蛇头是否与食物坐标重合
- 食物被吃后重新生成
- 确保食物不生成在蛇身体上

**输出：** 食物的显示位置和碰撞检测结果

**边界条件：**
- 食物位置必须在游戏区域内
- 食物不应生成在蛇的身体上

### 功能5：蛇身体增长

**描述：** 当蛇吃到食物时，身体长度增加。

**输入：** 蛇吃到食物的事件

**处理：** 
- 在蛇身体列表末尾添加一个新节点
- 更新得分

**输出：** 蛇的身体变长，得分增加

**边界条件：**
- 确保新增的身体节点位置正确

### 功能6：碰撞检测（游戏结束条件）

**描述：** 检测蛇是否撞墙或撞到自己，触发游戏结束。

**输入：** 蛇头的当前位置和蛇身体的所有位置

**处理：** 
- 检查蛇头是否超出游戏区域边界
- 检查蛇头是否与身体的其他部分重合
- 满足条件时触发游戏结束

**输出：** 游戏结束状态和最终得分显示

**边界条件：**
- 准确判断碰撞（边界和自身）
- 游戏结束后提供重新开始选项

### 功能7：界面渲染

**描述：** 在游戏窗口中绘制游戏元素和信息。

**输入：** 游戏状态（蛇的位置、食物位置、得分等）

**处理：** 
- 清空画面
- 绘制游戏区域背景
- 绘制蛇的身体（方块）
- 绘制食物
- 显示得分文本
- 游戏结束时显示结束信息

**输出：** 更新的游戏画面

**边界条件：**
- 确保渲染性能良好
- 各元素颜色区分明显

## 非功能需求

### 性能要求

- 游戏帧率稳定在30-60 FPS
- 键盘响应延迟 < 50ms
- 游戏启动时间 < 3秒
- 内存占用 < 100MB

### 安全要求

- 不包含恶意代码
- 不收集用户数据
- 依赖包来源可信（使用官方PyPI源）

### 可用性要求

- 代码简洁易懂，适合初学者阅读
- 提供详细的README文档
- 变量和函数命名清晰
- 适当的代码注释

### 兼容性要求

- Python 3.8+
- 支持主流操作系统（Windows、macOS、Linux）
- 使用跨平台的pygame库

## 技术方案建议

### 推荐技术栈

- **Python 3.8+**: 主要编程语言，广泛使用且文档完善
- **pygame**: Python游戏开发库，简单易用，适合2D游戏开发
- **uv**: 现代Python包管理工具，快速且易于使用
- **pyproject.toml**: Python项目配置文件，符合PEP标准

### 架构建议

采用简单的单文件架构（如果代码量小）或模块化架构：

```
game/
├── pyproject.toml          # uv项目配置
├── README.md               # 项目说明文档
├── snake_game.py           # 主游戏文件
└── .python-version         # Python版本指定（可选）
```

或者更结构化的方案：

```
game/
├── pyproject.toml
├── README.md
├── src/
│   └── snake/
│       ├── __init__.py
│       ├── game.py         # 游戏主逻辑
│       ├── snake.py        # 蛇类
│       └── food.py         # 食物类
└── main.py                 # 入口文件
```

### 关键技术点

- **游戏循环**: 使用pygame的事件循环和时钟控制
- **坐标系统**: 使用网格坐标系统，简化碰撞检测
- **状态管理**: 维护游戏状态（运行中、暂停、结束）
- **事件处理**: 使用pygame的事件系统处理键盘输入
- **渲染优化**: 只在状态变化时更新画面

### 示例代码结构

```python
# 游戏主要组成部分
class Snake:
    def __init__(self):
        self.body = []  # 蛇身体坐标列表
        self.direction = 'RIGHT'
    
    def move(self):
        # 移动逻辑
        pass
    
    def grow(self):
        # 增长逻辑
        pass

class Game:
    def __init__(self):
        pygame.init()
        self.screen = pygame.display.set_mode((WIDTH, HEIGHT))
        self.snake = Snake()
        self.food = None
        self.score = 0
    
    def run(self):
        # 游戏主循环
        while True:
            self.handle_events()
            self.update()
            self.render()
            self.clock.tick(FPS)
```

## 验收标准

### 功能验收

- [ ] game目录已创建，包含完整的uv项目结构
- [ ] 可以通过uv命令安装依赖并运行游戏
- [ ] 使用方向键可以控制蛇的移动方向
- [ ] 蛇可以正常吃到食物并增长身体
- [ ] 得分功能正常工作，每吃一个食物得分增加
- [ ] 撞墙或撞到自己时游戏正确结束
- [ ] 游戏结束后显示最终得分
- [ ] 可以重新开始游戏（按特定键或关闭窗口重启）

### 性能验收

- [ ] 游戏运行流畅，无明显卡顿
- [ ] 键盘输入响应及时
- [ ] 游戏可以稳定运行10分钟以上无崩溃

### 用户体验验收

- [ ] 游戏界面清晰，蛇、食物、得分易于识别
- [ ] 操作直观，无需说明即可上手
- [ ] README文档清晰，包含安装和运行步骤
- [ ] 代码结构清晰，易于理解和修改

### 文档验收

- [ ] README包含项目简介
- [ ] README包含安装步骤（uv安装和依赖安装）
- [ ] README包含运行命令
- [ ] README包含游戏玩法说明（控制键）
- [ ] 代码包含必要的注释

## 约束与限制

### 技术约束

- 必须使用uv作为Python包管理工具
- 必须使用Python 3.8或更高版本
- 游戏实现应保持简单，避免过度设计
- 建议使用pygame库（轻量且成熟）

### 时间约束

- 建议在2-3天内完成基本实现
- 任务应简化为单个可执行任务

### 资源约束

- 单人即可完成开发
- 不需要额外的外部资源（图片、音频等）
- 使用纯代码绘制游戏元素（简单方块）

### 范围约束

- 只实现基本的贪吃蛇游戏
- 不追求复杂的视觉效果
- 不实现高级功能（如AI、多人模式等）

## 风险评估

### 潜在风险

| 风险 | 影响程度 | 发生概率 | 缓解措施 |
|------|---------|---------|---------|
| uv工具不熟悉导致配置问题 | 中 | 中 | 提供详细的uv使用文档和示例命令 |
| pygame库在不同平台上的兼容性问题 | 低 | 低 | 使用pygame的稳定版本，测试主流平台 |
| 游戏逻辑bug（如碰撞检测错误） | 中 | 中 | 充分测试各种边界情况，编写清晰的逻辑代码 |
| 代码过于复杂不利于学习 | 中 | 中 | 保持代码简洁，添加适当注释，避免过度设计 |
| 依赖安装失败 | 低 | 低 | 使用可靠的依赖版本，提供故障排除指南 |

### 依赖关系

- uv工具的安装和配置
- pygame库的正常安装
- Python环境（3.8+）
- 操作系统的图形界面支持

## 实施建议

### 优先级

- **优先级**: 中
- **紧急程度**: 一般

### 预估工作量

- **预估时间**: 2-3天
- **复杂度**: 低

### 建议的实施阶段

1. **第一阶段：项目初始化（0.5天）**
   - 创建game目录
   - 使用uv初始化项目
   - 配置pyproject.toml
   - 添加pygame依赖
   - 创建基本的项目结构

2. **第二阶段：核心功能实现（1天）**
   - 实现游戏主循环
   - 实现蛇的移动和控制
   - 实现食物生成
   - 实现碰撞检测
   - 实现得分功能

3. **第三阶段：界面和文档（0.5天）**
   - 完善游戏界面渲染
   - 添加游戏结束画面
   - 编写README文档
   - 测试和调试

4. **第四阶段：测试和优化（0.5-1天）**
   - 在不同平台测试
   - 修复发现的bug
   - 优化游戏性能
   - 代码清理和注释

### 推荐开发流程

1. 先创建最小可运行版本（MVP）
2. 逐步添加功能
3. 每个功能完成后进行测试
4. 保持代码简洁，及时重构
5. 编写文档和注释

### 技术选型建议

- **单文件 vs 多文件**: 如果代码 < 200行，使用单文件；否则拆分模块
- **pygame vs 其他库**: pygame是最佳选择，成熟稳定，文档丰富
- **网格大小**: 建议20x20像素一个格子，游戏区域600x400像素
- **游戏速度**: 建议蛇每秒移动8-10格

## 补充信息

### 参考资料

- [uv官方文档](https://github.com/astral-sh/uv)
- [pygame官方文档](https://www.pygame.org/docs/)
- [Python官方文档](https://docs.python.org/zh-cn/3/)
- [贪吃蛇游戏经典实现参考](https://en.wikipedia.org/wiki/Snake_(video_game_genre))

### 相关Issue/PR

- Issue #11: 贪吃蛇游戏需求

### 技术参考

**uv常用命令：**
```bash
# 安装uv
curl -LsSf https://astral.sh/uv/install.sh | sh

# 初始化项目
uv init game
cd game

# 添加依赖
uv add pygame

# 运行项目
uv run python snake_game.py
```

**pygame基本用法：**
```python
import pygame

pygame.init()
screen = pygame.display.set_mode((WIDTH, HEIGHT))
clock = pygame.time.Clock()

while running:
    for event in pygame.event.get():
        if event.type == pygame.QUIT:
            running = False
    
    # 更新游戏状态
    # 渲染画面
    
    pygame.display.flip()
    clock.tick(30)

pygame.quit()
```

---

## 审批说明

**请审查以下内容：**

1. ✅ 需求描述是否清晰完整
2. ✅ 功能范围是否合理
3. ✅ 验收标准是否明确可测
4. ✅ 风险评估是否充分
5. ✅ 技术方案是否可行

**审批操作：**

- **通过**: 合并此PR，系统将自动生成Spec（需求规格说明书）
- **修改**: 在PR中提出修改意见，Copilot会根据反馈调整
- **拒绝**: 关闭PR并在原Issue中说明原因

---

**注意**: 本文档由Copilot根据用户的简单需求描述自动生成，旨在帮助用户快速形成完整的需求文档。审批通过后将进入正式的Spec → Plan → Implementation流程。
