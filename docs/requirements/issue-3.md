# 需求文档

> **Issue**: #3
> **创建时间**: 2026-02-05
> **状态**: 待审批

## 需求概述

### 需求描述

在项目根目录下创建一个 `game` 目录，用于存放 Python 小游戏项目。在该目录中实现一个简单的贪吃蛇游戏（Snake Game），使用 Python 开发，并通过 uv 工具进行 Python 环境和依赖管理。

贪吃蛇游戏应该保持简单易懂的设计，适合学习和演示目的，包含基本的游戏玩法：蛇移动、吃食物、增长、碰撞检测等核心功能。

### 用意与目标

**主要目标：**
- 熟悉 Python 游戏开发的基础知识和流程
- 掌握使用 uv 工具管理 Python 项目的方法
- 建立项目的游戏开发示例代码库
- 为后续更多小游戏项目建立目录结构规范

**预期收益：**
- 提升 Python 编程能力，特别是游戏逻辑和事件处理方面
- 学习现代 Python 包管理工具（uv）的使用
- 积累可复用的游戏开发代码和经验
- 为团队提供学习和参考的示例项目

## 背景分析

### 当前问题

当前项目中缺少实践性的 Python 游戏开发示例，新手开发者难以快速上手游戏开发。同时，项目需要建立一个统一的小游戏存放目录，便于管理和扩展。

### 业务价值

- **学习价值**：提供实际可运行的游戏示例，帮助开发者理解游戏循环、事件处理、碰撞检测等核心概念
- **技术积累**：建立游戏开发的技术栈和最佳实践
- **项目扩展**：为后续添加更多小游戏奠定基础架构

### 用户场景

1. **学习者场景**：Python 初学者想要通过实际项目学习游戏开发
2. **开发者场景**：开发者需要快速了解如何使用 uv 管理 Python 项目
3. **扩展场景**：未来可以在 game 目录下添加更多类型的小游戏

## 功能范围

### 包含功能

- ✅ 创建 `game` 目录结构
- ✅ 实现基础的贪吃蛇游戏逻辑
  - 蛇的移动控制（上下左右）
  - 食物的随机生成
  - 蛇吃到食物后增长
  - 碰撞检测（撞墙、撞自己）
  - 游戏结束判定
- ✅ 游戏界面显示
  - 游戏区域渲染
  - 得分显示
  - 游戏状态提示
- ✅ 使用 uv 进行项目管理
  - pyproject.toml 配置
  - 依赖管理
- ✅ 基本的 README 说明文档

### 不包含功能

- ❌ 复杂的游戏音效和背景音乐
- ❌ 多人联机对战功能
- ❌ 游戏难度等级系统
- ❌ 游戏数据持久化（保存最高分）
- ❌ 精美的游戏动画效果
- ❌ 游戏菜单系统（暂停、设置等）

## 用户故事

### 用户故事1：运行贪吃蛇游戏

**作为** Python 学习者  
**我想要** 能够快速安装并运行贪吃蛇游戏  
**以便** 体验游戏开发的成果，了解游戏的基本实现

**验收标准：**
- [ ] 可以使用 uv 命令安装依赖
- [ ] 可以使用简单的命令启动游戏
- [ ] 游戏窗口正常显示
- [ ] 基本操作说明清晰明了

### 用户故事2：控制贪吃蛇移动

**作为** 游戏玩家  
**我想要** 使用方向键控制蛇的移动  
**以便** 让蛇吃到食物并避免碰撞

**验收标准：**
- [ ] 可以使用方向键（上下左右）控制蛇的移动方向
- [ ] 蛇的移动流畅且响应及时
- [ ] 蛇不能直接反向移动（如正在向右移动时不能直接向左）
- [ ] 移动速度适中，便于操作

### 用户故事3：游戏规则和结束

**作为** 游戏玩家  
**我想要** 明确的游戏规则和结束提示  
**以便** 了解如何获得分数以及何时游戏结束

**验收标准：**
- [ ] 蛇吃到食物后身体增长一格
- [ ] 每吃到一个食物得分增加
- [ ] 蛇撞到墙壁或自己身体时游戏结束
- [ ] 游戏结束时显示最终得分
- [ ] 可以选择重新开始游戏或退出

## 功能需求

### 功能1：游戏初始化

**描述：** 初始化游戏窗口、蛇的初始位置、第一个食物的位置和游戏状态

**输入：** 无（程序启动）

**处理：**
- 创建游戏窗口（推荐大小 600x400 像素）
- 设置蛇的初始位置（屏幕中央，长度为3格）
- 随机生成第一个食物的位置
- 初始化得分为0
- 设置游戏状态为进行中

**输出：** 显示初始游戏界面

**边界条件：**
- 游戏窗口大小必须足够显示游戏区域
- 初始食物位置不能与蛇的初始位置重叠

### 功能2：蛇的移动控制

**描述：** 响应键盘输入，控制蛇的移动方向

**输入：** 方向键输入（上、下、左、右）

**处理：**
- 检测键盘事件
- 验证移动方向的合法性（不能反向移动）
- 更新蛇头的移动方向
- 按照固定时间间隔更新蛇的位置

**输出：** 蛇在屏幕上移动

**边界条件：**
- 当前向右移动时，不能直接改变方向向左（其他方向同理）
- 移动速度保持恒定（如每秒10格）

### 功能3：食物系统

**描述：** 管理食物的生成、显示和消费

**输入：** 游戏状态（是否需要生成新食物）

**处理：**
- 在游戏区域内随机生成食物位置
- 确保食物不与蛇身体重叠
- 检测蛇头是否到达食物位置
- 如果吃到食物，增加得分并生成新食物

**输出：** 食物在屏幕上显示，得分更新

**边界条件：**
- 食物位置必须在游戏区域内
- 食物不能生成在蛇身体所在的格子上

### 功能4：碰撞检测

**描述：** 检测蛇是否发生碰撞（撞墙或撞自己）

**输入：** 蛇的当前位置和移动方向

**处理：**
- 检测蛇头是否超出游戏区域边界
- 检测蛇头是否与自己的身体发生碰撞
- 如果发生碰撞，触发游戏结束

**输出：** 游戏结束标志和最终得分显示

**边界条件：**
- 蛇头坐标超出边界即判定为撞墙
- 蛇头坐标与身体任一节点重合即判定为撞自己

### 功能5：游戏渲染

**描述：** 在屏幕上绘制游戏元素

**输入：** 游戏状态数据（蛇的位置、食物位置、得分等）

**处理：**
- 清空屏幕
- 绘制游戏区域背景
- 绘制蛇（区分蛇头和身体）
- 绘制食物
- 显示当前得分
- 显示游戏状态信息

**输出：** 更新的游戏画面

**边界条件：**
- 刷新频率应保持稳定（如60 FPS）
- 所有游戏元素必须在游戏窗口内显示

## 非功能需求

### 性能要求

- 游戏运行帧率 ≥ 30 FPS，确保流畅的游戏体验
- 键盘响应延迟 < 100ms
- 游戏启动时间 < 3秒
- 内存占用 < 100MB

### 安全要求

- 代码无恶意操作
- 不收集用户隐私数据
- 不访问不必要的系统资源

### 可用性要求

- 游戏操作简单直观，新手可在1分钟内上手
- 提供清晰的操作说明
- 错误提示友好明确
- 支持优雅退出（按 ESC 或关闭窗口）

### 兼容性要求

- 支持 Python 3.10+
- 支持主流操作系统：Windows, macOS, Linux
- 使用跨平台的游戏库（如 pygame）

## 技术方案建议

### 推荐技术栈

- **Python 3.10+**: 使用现代 Python 版本，支持最新语法特性
- **pygame**: 成熟的 Python 游戏开发库，跨平台支持良好，文档丰富
- **uv**: 现代 Python 包管理器，速度快，易于使用
- **pyproject.toml**: 标准的 Python 项目配置文件

### 架构建议

```
game/
├── snake/
│   ├── __init__.py
│   ├── main.py          # 游戏主程序入口
│   ├── game.py          # 游戏核心逻辑
│   ├── snake.py         # 蛇类实现
│   ├── food.py          # 食物类实现
│   └── config.py        # 游戏配置（颜色、尺寸等）
├── pyproject.toml       # uv 项目配置
├── README.md            # 游戏说明文档
└── .python-version      # Python 版本指定
```

### 关键技术点

- **游戏循环（Game Loop）**：使用 pygame 的事件循环，控制游戏运行
- **状态管理**：使用列表或队列管理蛇身体的各个节点坐标
- **碰撞检测算法**：通过坐标比较实现简单高效的碰撞检测
- **事件处理**：使用 pygame 的事件系统处理键盘输入
- **随机算法**：使用 random 模块生成食物随机位置

## 验收标准

### 功能验收

- [ ] 成功创建 `game` 目录结构
- [ ] 使用 `uv init` 初始化 Python 项目
- [ ] 使用 `uv add pygame` 添加 pygame 依赖
- [ ] 游戏可以正常启动并显示游戏窗口
- [ ] 蛇可以使用方向键正常移动（上下左右）
- [ ] 蛇移动时禁止直接反向移动
- [ ] 食物随机出现在游戏区域内
- [ ] 蛇吃到食物后身体增长一格
- [ ] 吃到食物后得分增加
- [ ] 新食物在旧食物被吃掉后重新生成
- [ ] 蛇撞到墙壁时游戏结束
- [ ] 蛇撞到自己身体时游戏结束
- [ ] 游戏结束时显示最终得分
- [ ] 提供 README 文档说明如何运行游戏

### 性能验收

- [ ] 游戏运行流畅，无明显卡顿
- [ ] 键盘输入响应及时
- [ ] 启动速度快（3秒内）

### 用户体验验收

- [ ] 游戏界面清晰易懂
- [ ] 操作说明简单明了
- [ ] 蛇和食物的视觉区分明显
- [ ] 得分实时更新显示
- [ ] 游戏结束提示清晰

## 约束与限制

### 技术约束

- 必须使用 uv 作为 Python 包管理工具
- 游戏应保持简单，不追求复杂特性
- 代码应清晰易读，适合学习参考
- 使用 Python 标准库和 pygame，避免引入过多依赖

### 时间约束

- 建议实现时间：2-3 天
- 这是一个学习性项目，注重质量而非速度

### 资源约束

- 单人开发即可完成
- 无需额外的美术资源（使用简单几何图形）
- 无需服务器或数据库支持

## 风险评估

### 潜在风险

| 风险 | 影响程度 | 发生概率 | 缓解措施 |
|------|---------|---------|---------|
| pygame 在某些平台安装困难 | 中 | 低 | 提供详细的安装文档，使用 uv 自动处理依赖 |
| 游戏性能在低配置机器上不佳 | 低 | 低 | 优化渲染逻辑，降低刷新频率 |
| uv 工具使用不熟悉导致配置错误 | 中 | 中 | 提供完整的 uv 使用示例和命令说明 |
| 碰撞检测逻辑出现 bug | 中 | 中 | 编写充分的测试用例，进行多次游戏测试 |

### 依赖关系

- Python 3.10+ 环境
- uv 包管理工具（需要提前安装）
- pygame 库（通过 uv 安装）
- 显示器和键盘（硬件要求）

## 实施建议

### 优先级

- **优先级**: 中
- **紧急程度**: 不紧急

这是一个学习和演示性质的项目，不影响核心业务功能，可以按照正常开发节奏进行。

### 预估工作量

- **预估时间**: 2-3 天
- **复杂度**: 低-中

详细工作量分解：
- 环境搭建和项目初始化：0.5 天
- 核心游戏逻辑实现：1 天
- 界面渲染和优化：0.5 天
- 测试和文档编写：0.5-1 天

### 建议的实施阶段

1. **阶段1：项目初始化**（0.5天）
   - 创建 game 目录结构
   - 使用 uv 初始化项目
   - 配置 pyproject.toml
   - 添加 pygame 依赖

2. **阶段2：核心功能开发**（1天）
   - 实现游戏主循环
   - 实现蛇的移动逻辑
   - 实现食物生成和消费
   - 实现碰撞检测

3. **阶段3：界面和交互**（0.5天）
   - 实现游戏渲染
   - 优化视觉效果
   - 添加得分显示
   - 实现游戏结束界面

4. **阶段4：测试和文档**（0.5-1天）
   - 进行功能测试
   - 修复发现的 bug
   - 编写 README 文档
   - 添加代码注释

## 补充信息

### 参考资料

- [pygame 官方文档](https://www.pygame.org/docs/)
- [uv 官方文档](https://github.com/astral-sh/uv)
- [Python 贪吃蛇游戏教程](https://realpython.com/pygame-a-primer/)
- [Python pyproject.toml 规范](https://packaging.python.org/en/latest/guides/writing-pyproject-toml/)

### 相关Issue/PR

- Issue #3: 贪吃蛇游戏

---

## 审批说明

**请审查以下内容：**

1. ✅ 需求描述是否清晰完整
2. ✅ 功能范围是否合理
3. ✅ 验收标准是否明确可测
4. ✅ 风险评估是否充分
5. ✅ 技术方案是否可行

**审批操作：**

- **通过**: 合并此PR，系统将自动生成Spec（需求规格说明书）
- **修改**: 在PR中提出修改意见，Copilot会根据反馈调整
- **拒绝**: 关闭PR并在原Issue中说明原因

---

**注意**: 本文档由Copilot根据用户的简单需求描述自动生成，旨在帮助用户快速形成完整的需求文档。审批通过后将进入正式的Spec → Plan → Implementation流程。
