# 需求文档

> **Issue**: #8
> **创建时间**: 2026-02-06
> **状态**: 待审批

## 需求概述

### 需求描述

在项目根目录下创建一个 `game` 目录，用于存放Python小游戏项目。首个项目是实现一个经典的贪吃蛇游戏。该游戏需要保持简洁易懂的设计，使用 `uv` 作为Python包管理工具，便于依赖管理和环境控制。

### 用意与目标

**主要目标：**
- 搭建Python游戏开发的基础目录结构
- 实现一个简单但完整的贪吃蛇游戏
- 熟悉和实践Python游戏开发流程
- 掌握使用 `uv` 进行Python项目依赖管理
- 为后续添加更多Python小游戏打下基础

**预期收益：**
- 积累Python游戏开发经验
- 建立可复用的游戏项目结构模板
- 提升Python编程和项目管理能力
- 为学习和演示目的提供实际可运行的游戏案例

## 背景分析

### 当前问题

项目目前缺少实际的Python应用案例，特别是在游戏开发领域。需要一个简单但完整的示例项目来展示Python的应用能力，同时也能作为学习和实践的素材。

### 业务价值

- **教育价值**：贪吃蛇游戏作为经典游戏，非常适合用于教学和学习Python编程
- **技术展示**：展示Python在游戏开发中的应用能力
- **项目规范**：建立标准的Python项目结构，为后续项目提供参考
- **工具实践**：实践现代Python包管理工具 `uv` 的使用

### 用户场景

1. **学习者**：想要通过实际项目学习Python编程和游戏开发基础
2. **开发者**：需要快速搭建一个Python小游戏项目进行测试或演示
3. **教育者**：需要一个简单的游戏案例用于教学演示

## 功能范围

### 包含功能

- ✅ 创建 `game` 目录作为游戏项目容器
- ✅ 实现基础的贪吃蛇游戏逻辑
  - 蛇的移动控制（上、下、左、右）
  - 食物的随机生成
  - 蛇吃食物后长度增加
  - 碰撞检测（撞墙、撞自己）
  - 游戏结束判定
- ✅ 简单的图形界面显示
- ✅ 分数统计功能
- ✅ 使用 `uv` 管理项目依赖
- ✅ 提供清晰的项目README说明文档

### 不包含功能

- ❌ 复杂的游戏音效和背景音乐
- ❌ 多人对战模式
- ❌ 关卡系统和难度递进
- ❌ 游戏存档和历史记录
- ❌ 网络联机功能
- ❌ 高级图形特效和动画
- ❌ 移动端适配

## 用户故事

### 用户故事1：游戏基础操作

**作为** 游戏玩家  
**我想要** 使用方向键控制贪吃蛇的移动  
**以便** 能够引导蛇吃到食物并避免碰撞

**验收标准：**
- [ ] 可以使用键盘方向键（↑↓←→）或 WASD 键控制蛇的移动方向
- [ ] 蛇的移动流畅，响应及时
- [ ] 蛇不能直接反向移动（例如向右移动时不能直接向左）

### 用户故事2：游戏进度反馈

**作为** 游戏玩家  
**我想要** 实时看到当前分数和游戏状态  
**以便** 了解游戏进度和挑战自己的最高分

**验收标准：**
- [ ] 游戏界面显示当前分数
- [ ] 每吃一个食物分数增加
- [ ] 游戏结束时显示最终分数

### 用户故事3：快速启动游戏

**作为** 开发者或玩家  
**我想要** 能够快速安装依赖并启动游戏  
**以便** 立即开始游戏体验

**验收标准：**
- [ ] 提供清晰的安装和运行说明
- [ ] 使用 `uv` 一键安装所有依赖
- [ ] 简单的命令即可启动游戏

## 功能需求

### 功能1：游戏初始化

**描述：** 游戏启动时初始化游戏窗口、蛇的初始位置、初始食物位置和游戏状态。

**输入：** 无（程序启动）

**处理：**
- 创建游戏窗口（建议大小：600x400像素或适当大小）
- 初始化蛇的位置（窗口中央，初始长度3-5节）
- 随机生成第一个食物的位置
- 初始化分数为0
- 设置游戏运行状态为活跃

**输出：** 显示初始游戏界面

**边界条件：**
- 窗口大小需要合理，不能太小或太大
- 初始蛇的位置不能与食物重叠

### 功能2：蛇的移动控制

**描述：** 响应玩家的键盘输入，控制蛇的移动方向。

**输入：** 键盘方向键或 WASD 键

**处理：**
- 检测键盘输入事件
- 更新蛇的移动方向
- 验证方向变化的合法性（不能180度转向）
- 根据当前方向移动蛇的位置

**输出：** 蛇在游戏窗口中移动

**边界条件：**
- 蛇向右移动时不能直接向左
- 蛇向上移动时不能直接向下
- 连续快速按键时只响应第一次有效输入

### 功能3：食物生成与碰撞检测

**描述：** 在游戏区域内随机生成食物，并检测蛇是否吃到食物。

**输入：** 蛇的当前位置

**处理：**
- 在游戏区域内随机生成食物坐标
- 确保食物不生成在蛇身上
- 检测蛇头位置是否与食物重叠
- 如果吃到食物：
  - 蛇身长度增加一节
  - 分数增加
  - 重新生成新食物

**输出：** 食物显示在游戏界面，蛇吃到食物后长度增加

**边界条件：**
- 食物位置必须在游戏区域内
- 食物不能生成在蛇身上
- 食物坐标需要对齐网格

### 功能4：碰撞检测与游戏结束

**描述：** 检测蛇是否撞墙或撞到自己，并处理游戏结束逻辑。

**输入：** 蛇的当前位置

**处理：**
- 检测蛇头是否超出游戏边界（撞墙）
- 检测蛇头是否与蛇身任意部分重叠（撞自己）
- 如果发生碰撞：
  - 停止游戏循环
  - 显示游戏结束信息
  - 显示最终分数
  - 提供重新开始选项

**输出：** 游戏结束画面和最终分数

**边界条件：**
- 必须准确检测所有碰撞情况
- 游戏结束后应停止所有游戏逻辑

### 功能5：游戏界面渲染

**描述：** 实时渲染游戏画面，包括蛇、食物、分数等元素。

**输入：** 当前游戏状态（蛇的位置、食物位置、分数）

**处理：**
- 清除上一帧画面
- 绘制游戏边界/背景
- 绘制蛇身（区分蛇头和蛇身）
- 绘制食物
- 显示当前分数
- 刷新显示

**输出：** 更新后的游戏画面

**边界条件：**
- 帧率需要保持稳定（建议10-15 FPS）
- 渲染性能需要流畅，无明显卡顿

## 非功能需求

### 性能要求

- 游戏运行流畅，帧率稳定在10-15 FPS
- 键盘响应延迟 < 50ms
- 游戏启动时间 < 3秒
- 内存占用 < 100MB

### 安全要求

- 无需特殊安全要求（单机游戏）
- 不收集用户数据
- 不需要网络连接

### 可用性要求

- 游戏界面简洁清晰，易于理解
- 操作说明明确，新手可快速上手
- 代码结构清晰，易于阅读和维护
- 提供详细的README文档

### 兼容性要求

- 支持 Python 3.8+
- 支持主流操作系统（Windows、macOS、Linux）
- 依赖库保持最小化，优先使用标准库

## 技术方案建议

### 推荐技术栈

- **Python**: 使用 Python 3.8+ 作为开发语言
- **uv**: 用于Python包管理和虚拟环境管理（快速、现代的工具）
- **pygame**: 推荐使用 pygame 库实现游戏图形界面和交互（简单易用，文档丰富）
- **替代方案**: 也可以使用 tkinter（Python标准库，无需额外安装）或 curses（终端界面）

### 架构建议

**项目结构：**
```
game/
├── snake_game/
│   ├── __init__.py
│   ├── main.py          # 游戏主入口
│   ├── game.py          # 游戏核心逻辑
│   ├── snake.py         # 蛇类定义
│   ├── food.py          # 食物类定义
│   └── config.py        # 游戏配置（窗口大小、颜色、速度等）
├── README.md            # 项目说明文档
├── pyproject.toml       # uv 项目配置文件
└── .python-version      # Python版本指定
```

**设计模式：**
- 使用面向对象设计，将蛇、食物、游戏逻辑分离为不同的类
- 使用配置文件统一管理游戏参数，便于调整
- 保持简单设计原则（KISS），避免过度设计

### 关键技术点

- **游戏循环**: 实现标准的游戏主循环（事件处理 → 更新状态 → 渲染画面）
- **帧率控制**: 使用定时器控制游戏更新频率
- **碰撞检测**: 使用坐标比较实现简单高效的碰撞检测
- **随机生成**: 使用 random 模块生成食物位置
- **事件处理**: 处理键盘输入事件，更新蛇的移动方向
- **uv 使用**: 
  - 使用 `uv init` 初始化项目
  - 使用 `uv add` 添加依赖
  - 使用 `uv run` 运行游戏

## 验收标准

### 功能验收

- [ ] 游戏能够正常启动并显示初始界面
- [ ] 可以使用方向键或 WASD 控制蛇的移动
- [ ] 蛇能够正确吃到食物并增加长度
- [ ] 分数能够正确统计和显示
- [ ] 撞墙或撞到自己时游戏正确结束
- [ ] 游戏结束后显示最终分数
- [ ] 可以重新开始游戏
- [ ] 使用 `uv` 可以成功安装依赖并运行游戏

### 性能验收

- [ ] 游戏运行流畅，无明显卡顿
- [ ] 键盘操作响应及时
- [ ] 游戏启动速度快（< 3秒）

### 用户体验验收

- [ ] 游戏界面清晰美观
- [ ] 操作逻辑符合直觉
- [ ] 提供清晰的README文档
- [ ] 代码结构清晰，注释充分

## 约束与限制

### 技术约束

- 必须使用 `uv` 作为Python包管理工具
- 必须使用Python 3.8或更高版本
- 游戏应保持简单，避免过度复杂的功能
- 优先使用Python标准库，最小化外部依赖

### 时间约束

- 建议在一个开发周期（1-2天）内完成基础功能
- 作为单一任务完成，避免功能蔓延

### 资源约束

- 作为学习和演示项目，不需要高性能优化
- 代码应注重可读性和教育性
- 不需要专业的美术资源，简单图形即可

## 风险评估

### 潜在风险

| 风险 | 影响程度 | 发生概率 | 缓解措施 |
|------|---------|---------|---------|
| pygame 在某些系统上安装困难 | 中 | 中 | 提供 tkinter 作为备选方案，或提供详细的安装说明 |
| uv 工具不熟悉导致配置问题 | 低 | 中 | 提供详细的 uv 使用说明和示例命令 |
| 游戏性能在低端设备上不佳 | 低 | 低 | 优化游戏循环，降低帧率需求 |
| 功能范围蔓延导致项目复杂化 | 中 | 中 | 严格控制功能范围，专注核心功能 |

### 依赖关系

- Python 3.8+ 环境
- uv 包管理工具
- pygame 或 tkinter 图形库
- 无其他项目依赖

## 实施建议

### 优先级

- **优先级**: 中
- **紧急程度**: 不紧急

### 预估工作量

- **预估时间**: 1-2天
- **复杂度**: 低
  - 游戏逻辑相对简单
  - 技术栈成熟，文档丰富
  - 无复杂的依赖关系

### 建议的实施阶段

1. **阶段1：项目搭建（2-3小时）**
   - 创建 game 目录结构
   - 使用 uv 初始化项目
   - 安装必要的依赖（pygame）
   - 创建基础文件框架

2. **阶段2：核心功能实现（4-6小时）**
   - 实现蛇类和食物类
   - 实现游戏主循环
   - 实现移动控制和碰撞检测
   - 实现基础的界面渲染

3. **阶段3：完善和测试（2-3小时）**
   - 添加分数统计
   - 优化游戏体验
   - 编写 README 文档
   - 测试各项功能
   - 代码清理和注释

## 补充信息

### 参考资料

- [Python Pygame 官方文档](https://www.pygame.org/docs/)
- [uv 官方文档](https://github.com/astral-sh/uv)
- [贪吃蛇游戏经典实现参考](https://github.com/topics/snake-game?l=python)
- [Python 游戏开发教程](https://realpython.com/pygame-a-primer/)

### 相关Issue/PR

- 原始 Issue: #8

---

## 审批说明

**请审查以下内容：**

1. ✅ 需求描述是否清晰完整
2. ✅ 功能范围是否合理
3. ✅ 验收标准是否明确可测
4. ✅ 风险评估是否充分
5. ✅ 技术方案是否可行

**审批操作：**

- **通过**: 合并此PR，系统将自动生成Spec（需求规格说明书）
- **修改**: 在PR中提出修改意见，Copilot会根据反馈调整
- **拒绝**: 关闭PR并在原Issue中说明原因

---

**注意**: 本文档由Copilot根据用户的简单需求描述自动生成，旨在帮助用户快速形成完整的需求文档。审批通过后将进入正式的Spec → Plan → Implementation流程。
