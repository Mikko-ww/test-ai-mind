---
# 执行计划配置文件
# Parent Issue: #33
# 创建时间: 2026-02-11

metadata:
  parent_issue: 33
  spec_doc: "docs/specs/issue-33.md"
  total_tasks: 5
  completed: 0
  status: pending
  last_updated: 2026-02-11T10:32:37.500Z

# 任务列表
tasks:
  - id: task-1
    title: "创建game目录结构和项目配置"
    level: L1
    status: pending
    estimated_effort: Small
    description: |
      创建game目录结构，配置uv项目环境，包括pyproject.toml和基本的README文档。
    acceptance_criteria:
      - game目录已创建
      - pyproject.toml配置完成，包含pygame依赖
      - README.md包含项目说明和安装步骤
      - 使用uv init初始化项目
    deps: null
    prerequisites:
      - uv工具已在系统中可用
    implementation_notes:
      - 使用uv init创建项目结构
      - 在pyproject.toml中添加pygame依赖
      - 设置Python版本要求为3.10+
      - README需包含uv安装和使用说明
    testing_requirements:
      - 验证uv sync能正常安装依赖
      - 验证项目结构符合uv规范
    issue: null
    pr: null

  - id: task-2
    title: "实现蛇类（Snake）和基本移动逻辑"
    level: L2
    status: pending
    estimated_effort: Medium
    description: |
      实现Snake类，包含蛇的数据结构、移动逻辑、方向控制等核心功能。
    acceptance_criteria:
      - Snake类实现完成
      - 蛇能够按照指定方向移动
      - 蛇身体跟随蛇头移动
      - 防止蛇反向移动的逻辑实现
      - 蛇的增长逻辑实现
    deps:
      - task-1
    prerequisites:
      - game目录和项目环境已配置
    implementation_notes:
      - 使用列表存储蛇身坐标
      - 实现move方法更新蛇的位置
      - 实现grow方法增长蛇身
      - 实现change_direction方法控制方向
      - 添加方向验证，防止反向移动
    testing_requirements:
      - 单元测试验证移动逻辑
      - 测试方向控制功能
      - 测试蛇身增长逻辑
    issue: null
    pr: null

  - id: task-3
    title: "实现食物类（Food）和碰撞检测"
    level: L2
    status: pending
    estimated_effort: Small
    description: |
      实现Food类，负责食物的随机生成和位置管理。实现碰撞检测逻辑，包括吃食物、撞墙、撞自己。
    acceptance_criteria:
      - Food类实现完成
      - 食物能在随机位置生成
      - 食物不会生成在蛇身上
      - 碰撞检测逻辑实现（吃食物、撞墙、撞自己）
      - 碰撞检测准确无误
    deps:
      - task-2
    prerequisites:
      - Snake类已实现
    implementation_notes:
      - 使用random模块生成随机坐标
      - 验证食物位置不与蛇身重叠
      - 实现边界碰撞检测
      - 实现蛇身碰撞检测
      - 实现食物碰撞检测
    testing_requirements:
      - 测试食物随机生成逻辑
      - 测试各种碰撞检测场景
      - 边界条件测试
    issue: null
    pr: null

  - id: task-4
    title: "实现游戏管理类（Game）和pygame界面"
    level: L2
    status: pending
    estimated_effort: Medium
    description: |
      实现Game类管理游戏流程，使用pygame渲染游戏界面，处理键盘输入，显示分数和游戏状态。
    acceptance_criteria:
      - Game类实现完成
      - pygame窗口正常显示
      - 蛇和食物在界面上正确渲染
      - 键盘输入正常响应
      - 分数实时显示
      - 游戏结束时显示提示信息
    deps:
      - task-3
    prerequisites:
      - Snake类和Food类已实现
      - pygame依赖已安装
    implementation_notes:
      - 初始化pygame和游戏窗口
      - 实现游戏主循环
      - 实现事件处理（键盘输入、关闭窗口）
      - 实现渲染逻辑（背景、蛇、食物、分数）
      - 设置合适的游戏帧率（15-30 FPS）
      - 实现游戏结束界面
    testing_requirements:
      - 手动测试游戏界面显示
      - 测试键盘控制响应
      - 测试游戏流程完整性
    issue: null
    pr: null

  - id: task-5
    title: "完善文档和最终测试"
    level: L1
    status: pending
    estimated_effort: Small
    description: |
      完善README文档，添加详细的安装和运行说明，进行全面测试，确保游戏在不同环境下正常运行。
    acceptance_criteria:
      - README文档完整详细
      - 包含uv安装说明
      - 包含依赖安装步骤
      - 包含游戏启动命令
      - 包含游戏操作说明
      - 游戏在主流操作系统上测试通过
      - 代码添加必要注释
    deps:
      - task-4
    prerequisites:
      - 游戏核心功能已实现
    implementation_notes:
      - 更新README，添加详细的使用说明
      - 添加常见问题解决方案
      - 添加代码注释说明关键逻辑
      - 在不同环境进行测试
      - 修复测试中发现的问题
    testing_requirements:
      - 在Windows/macOS/Linux上测试
      - 验证安装文档的准确性
      - 进行端到端游戏测试
    issue: null
    pr: null

# 风险与注意事项
risks:
  overall:
    - pygame在某些系统上可能需要额外的系统依赖（如SDL）
    - uv作为较新的工具，可能在某些环境下遇到兼容性问题
    - 不同操作系统的pygame表现可能有差异
  critical_path:
    - task-2和task-3是核心功能，必须保证质量
    - task-4的pygame集成是关键路径
  blockers:
    - 如果pygame无法正常安装，可能需要添加详细的系统依赖安装说明
    - 如果uv在CI环境中有问题，可能需要提供替代方案或额外配置

# 执行策略
execution_strategy:
  mode: sequential
  description: |
    本计划采用严格串行执行策略：
    - 同一时间只有一个任务处于in-progress状态
    - 任务必须按照ID顺序执行
    - 前一个任务完成并合并后，才会开始下一个任务
  failure_handling:
    - 任务失败时进入blocked状态
    - 等待人工介入（/retry重试或/abort终止）
    - 修复后继续执行
  pause_resume:
    - 使用/pause命令暂停任务派发
    - 使用/resume命令恢复任务派发
    - 暂停期间不创建新的任务PR

# 状态定义
status_definitions:
  pending: "任务等待开始"
  in_progress: "任务正在执行（Copilot已被分配）"
  in_review: "任务PR已创建，等待审查/合并"
  blocked: "任务被阻塞，需要人工介入"
  done: "任务已完成并合并"
  cancelled: "任务被取消"
